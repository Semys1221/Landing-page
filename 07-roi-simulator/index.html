<!doctype html>
<html lang="fr">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Saturnin Gestion</title>
  
  <link rel="icon" type="image/png" href="../favicon.png">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      width: 100%;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #000000;
      color: #ffffff;
    }

    :root {
      --bg: #000000;
      --card: #050505;
      --border: #1a1a1a;
      --accent: #0070f3;
      --success: #00FF41;
      --error: #FF4D4D;
      --text-dim: #888888;
    }

    .simulator-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 50px;
      background: var(--card);
      border: 1px solid var(--border);
      padding: 50px;
      border-radius: 16px;
      max-width: 1100px;
      margin: 40px auto;
    }

    .config-section h2 {
      font-size: 1.5rem;
      margin-bottom: 30px;
      font-weight: 700;
      letter-spacing: -0.5px;
    }

    .input-group {
      margin-bottom: 28px;
    }

    .input-group label {
      display: block;
      font-size: 0.9rem;
      font-weight: 600;
      color: #ffffff;
      margin-bottom: 10px;
      letter-spacing: 0.5px;
    }

    .input-group label span {
      color: var(--accent);
      font-weight: 700;
      margin-left: 8px;
    }

    .segment-selector {
      display: flex;
      gap: 12px;
    }

    .segment-btn {
      flex: 1;
      padding: 14px;
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text-dim);
      border-radius: 4px;
      cursor: pointer;
      transition: 0.3s;
      font-weight: 600;
      font-size: 0.85rem;
    }

    .segment-btn:hover {
      border-color: var(--accent);
      color: #fff;
    }

    .segment-btn.active {
      border-color: var(--accent);
      color: #fff;
      background: rgba(0, 112, 243, 0.1);
    }

    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      background: var(--border);
      height: 4px;
      border-radius: 2px;
      outline: none;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      background: var(--accent);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 10px rgba(0, 112, 243, 0.5);
    }

    input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      background: var(--accent);
      border-radius: 50%;
      cursor: pointer;
      border: none;
      box-shadow: 0 0 10px rgba(0, 112, 243, 0.5);
    }

    input[type="number"] {
      width: 100%;
      padding: 12px;
      background: var(--border);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: #ffffff;
      font-size: 1rem;
      transition: border-color 0.3s;
    }

    input[type="number"]:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(0, 112, 243, 0.1);
    }

    .results-section {
      display: flex;
      flex-direction: column;
      gap: 30px;
      justify-content: flex-start;
    }

    .roi-display {
      background: linear-gradient(135deg, rgba(0, 255, 65, 0.1) 0%, rgba(0, 112, 243, 0.05) 100%);
      border: 1px solid rgba(0, 255, 65, 0.2);
      padding: 40px;
      border-radius: 12px;
      text-align: center;
    }

    .roi-label {
      font-size: 0.85rem;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 15px;
      font-weight: 700;
    }

    #roi-value {
      font-size: 5rem;
      font-weight: 800;
      color: var(--success);
      letter-spacing: -3px;
      transition: color 0.3s ease, transform 0.3s ease;
    }

    #roi-value.negative {
      color: var(--error);
    }

    .metric-card {
      background: rgba(0, 112, 243, 0.05);
      border: 1px solid var(--border);
      padding: 24px;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .metric-card span {
      color: var(--text-dim);
      font-size: 0.9rem;
      font-weight: 600;
    }

    #val-encours {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--accent);
    }

    .progress-container {
      margin-top: 20px;
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: var(--border);
      border-radius: 3px;
      overflow: hidden;
      margin-bottom: 12px;
    }

    .progress-fill {
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, var(--accent), var(--success));
      border-radius: 3px;
    }

    .progress-text {
      font-size: 0.8rem;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 600;
    }

    .next-step-container {
      grid-column: 1 / -1;
      display: flex;
      justify-content: center;
      margin-top: 30px;
    }

    .next-step-btn {
      background: transparent;
      color: var(--success);
      border: 2px solid var(--success);
      padding: 18px 45px;
      font-size: 1.1rem;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 2px;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.4s ease;
      box-shadow: 0 0 15px rgba(0, 255, 65, 0.1);
      animation: pulse-border 2s infinite;
    }

    .next-step-btn:hover {
      background: var(--success);
      color: #000;
      box-shadow: 0 0 30px rgba(0, 255, 65, 0.4);
      transform: translateY(-2px);
    }

    @keyframes pulse-border {
      0% { box-shadow: 0 0 0 0 rgba(0, 255, 65, 0.4); }
      70% { box-shadow: 0 0 0 15px rgba(0, 255, 65, 0); }
      100% { box-shadow: 0 0 0 0 rgba(0, 255, 65, 0); }
    }

    .footer-disclaimer {
      grid-column: 1 / -1;
      text-align: center;
      font-size: 0.75rem;
      color: var(--text-dim);
      margin-top: 20px;
      letter-spacing: 1px;
      text-transform: uppercase;
      font-weight: 700;
    }

    @media (max-width: 850px) {
      .simulator-container {
        grid-template-columns: 1fr;
        gap: 30px;
        padding: 30px;
      }

      #roi-value {
        font-size: 3.5rem;
      }
    }
  </style>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <style>body { box-sizing: border-box; }</style>
  <script src="https://cdn.tailwindcss.com/3.4.17" type="text/javascript"></script>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body>
  <div class="simulator-container">
   <div class="config-section">
    <h2>üèõÔ∏è Configuration Infrastructure</h2>
    <div class="input-group">
     <label>Segment de March√© Cible</label>
     <div class="segment-selector">
      <button class="segment-btn" id="btn-bnc" onclick="toggleSegment('BNC')">BNC (PER, Madelin)</button> <button class="segment-btn active" id="btn-bic" onclick="toggleSegment('BIC')">BIC (Tr√©so, Dutreil)</button>
     </div>
    </div>
    <div class="input-group">
     <label>Volume Infrastructure (90J) <span id="val-rdv">30 RDV</span></label> <input type="range" id="input-rdv" min="15" max="45" value="30" oninput="calculate()">
    </div>
    <div class="input-group">
     <label>Collecte Moyenne par dossier (‚Ç¨)</label> <input type="number" id="input-collecte" value="150000" oninput="calculate()">
    </div>
    <h2>‚öôÔ∏è Variables Cabinet</h2>
    <div class="input-group">
     <label>Taux Upfront (Frais d'entr√©e) <span id="val-upfront">2.5%</span></label> <input type="range" id="input-upfront" min="0" max="5" step="0.1" value="2.5" oninput="calculate()">
    </div>
    <div class="input-group">
     <label>Taux de Closing (Transformation) <span id="val-closing">20%</span></label> <input type="range" id="input-closing" min="0" max="100" value="20" oninput="calculate()">
    </div>
    <div class="input-group">
     <label>R√©mun√©ration sur Encours (Annuelle) <span id="val-encours-rate">0.7%</span></label> <input type="range" id="input-encours-rate" min="0" max="1.5" step="0.1" value="0.7" oninput="calculate()">
    </div>
   </div>
   <div class="results-section">
    <h2>üí∞ Verdict √âconomique</h2>
    <div class="roi-display">
     <div class="roi-label">
      COMMISSIONS ‚Äì PRIX D'ENTR√âE ESTIM√âES (90J)
     </div>
     <div id="roi-value">
      0‚Ç¨
     </div>
    </div>
    <div class="metric-card">
     <span>Valorisation de l'Encours</span>
     <div id="res-encours">
      0‚Ç¨
     </div>
    </div>
    <div class="metric-card">
     <span>Rente Annuelle G√©n√©r√©e</span>
     <div id="res-rente">
      0‚Ç¨
     </div>
    </div>
    <div class="input-group">
     <div class="progress-bar">
      <div class="progress-fill"></div>
     </div>
     <div class="progress-text">
      Cycle d'activation 90 jours valid√©
     </div>
    </div>
   </div>
   <div class="next-step-container"><button class="next-step-btn" id="btn-next" onclick="handleNextStep()"> VALIDER LA STRAT√âGIE ‚ûî </button>
   </div>
   <div class="footer-disclaimer">
    ESTIMATION BAS√âE SUR UN CYCLE D'ING√âNIERIE PATRIMONIALE COMPLET.
   </div>
  </div>
  <script>
    let activeSegments = ['BIC'];

    function calculate() {
      const rdv = parseInt(document.getElementById('input-rdv').value);
      const collecte = parseFloat(document.getElementById('input-collecte').value) || 0;
      const upfront = parseFloat(document.getElementById('input-upfront').value) / 100;
      const closing = parseFloat(document.getElementById('input-closing').value) / 100;
      const encoursRate = parseFloat(document.getElementById('input-encours-rate').value) / 100;

      // Mise √† jour des labels visuels
      document.getElementById('val-rdv').innerText = rdv + " RDV";
      document.getElementById('val-upfront').innerText = (upfront * 100).toFixed(1) + "%";
      document.getElementById('val-closing').innerText = Math.round(closing * 100) + "%";
      document.getElementById('val-encours-rate').innerText = (encoursRate * 100).toFixed(1) + "%";

      const nbDossiers = rdv * closing;
      
      // NOUVELLE LOGIQUE : FOCUS SUR LE CA BRUT (COMMISSIONS)
      const caImmediat = nbDossiers * (collecte * upfront);

      const valorisationEncours = nbDossiers * collecte;
      const renteAnnuelle = valorisationEncours * encoursRate;

      updateDisplay(caImmediat, valorisationEncours, renteAnnuelle);
    }

    function updateDisplay(roi, encours, rente) {
      const fmt = new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR', maximumFractionDigits: 0 });
      
      const roiEl = document.getElementById('roi-value');
      roiEl.innerText = fmt.format(roi);
      roiEl.style.color = roi < 0 ? "var(--error)" : "var(--success)";

      document.getElementById('res-encours').innerText = fmt.format(encours);
      document.getElementById('res-rente').innerText = fmt.format(rente);
    }

    function toggleSegment(seg) {
      const index = activeSegments.indexOf(seg);
      if (index > -1) { 
        if (activeSegments.length > 1) activeSegments.splice(index, 1); 
      } else { 
        activeSegments.push(seg); 
      }
      
      document.getElementById('btn-bnc').classList.toggle('active', activeSegments.includes('BNC'));
      document.getElementById('btn-bic').classList.toggle('active', activeSegments.includes('BIC'));

      const inputCollecte = document.getElementById('input-collecte');
      if (activeSegments.includes('BNC') && activeSegments.includes('BIC')) inputCollecte.value = 115000;
      else if (activeSegments.includes('BIC')) inputCollecte.value = 150000;
      else inputCollecte.value = 80000;
      
      calculate();
    }

    window.onload = calculate;

    function handleNextStep() {
      // Animation de succ√®s au clic
      const btn = document.getElementById('btn-next');
      btn.innerText = "TRANSITION EN COURS...";
      btn.style.borderColor = "var(--accent)";
      btn.style.color = "var(--accent)";
      
      // REDIRECTION VERS L'√âTAPE SUIVANTE
      setTimeout(() => {
        window.location.href = "../08-delivery-roadmap/";
      }, 800);
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9d3d2ce7e6a9e2fd',t:'MTc3MjA4NTEzNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
